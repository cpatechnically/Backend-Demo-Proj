'use strict';const e=React.createElement,useState=React.useState,useEffect=React.useEffect,baseURL="http://127.0.0.1:8000/",getCookies=a=>{var b={};return document.cookie&&""!==document.cookie&&document.cookie.split(";").forEach(function(a){var c=a.trim().match(/(\w+)=(.*)/);void 0!==c&&(b[c[1]]=decodeURIComponent(c[2]))}),a?b[a]:b},useDisplayMsg=()=>{//const [msg, isError, setDisplayMsg] = useDisplayMsg('')
const[a,b]=useState(""),[c,d]=useState(!1),e=(a,c)=>{b(a);d("true"===c+"")};return useEffect(()=>{let b;if(""!==a){b=setTimeout(()=>{e("",!1)},4000)}return()=>{clearTimeout(b)}}),[a,c,e]},CaptureEmailUI=a=>{const[b,c]=useState(""),[d,e,f]=useDisplayMsg(),{config:g}=a;return/*#__PURE__*/React.createElement("form",{className:g.formClass,onSubmit:a=>{a.preventDefault();const d=getCookies("csrftoken");//console.log("token",csrftoken)
//console.log(value)
if(d||f("This is not a valid embed.",!0),""===b||void 0===b||null===b)return void f("Value is required",!0);console.log(b);//send to backend
const e=JSON.stringify({email:b}),g=new XMLHttpRequest;g.open("POST",`${baseURL}api/captures/caps/`,!0),g.setRequestHeader("Content-Type","application/json"),g.setRequestHeader("X-CSRFTOKEN",d),g.onerror=()=>{f("Error! please try again later",!0)},g.onload=()=>{201===g.status?(c(""),f("Success! Your email is saved.",!1)):f("Error! please try again.",!0)},g.send(e)}},!e&&d&&/*#__PURE__*/React.createElement("div",{className:g.successClass?g.successClass:"alert alert-success"},d),/*#__PURE__*/React.createElement("input",{className:g.inputClass,value:b,onChange:a=>{c(a.target.value),f("",!1)},type:"email",placeholder:"your email"//required
}),e&&d&&/*#__PURE__*/React.createElement("p",{className:g.errorClass},d),"false"===g.btnShow?"":/*#__PURE__*/React.createElement("p",null,/*#__PURE__*/React.createElement("button",{className:g.btnClass,type:"submit"},"Save Email")))};// Find all DOM containers, and render our component into them.
var containers=document.querySelectorAll(".cap-ui");containers.forEach(a=>{//console.log(domContainer.dataset)
//Read the user ID from a data-* attribute.
//const userid = domContainer.dataset.userid
// render the component into the DOM
ReactDOM.render(e(CaptureEmailUI,{config:a.dataset}),a)});
